<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ page language="java" import="java.lang.*,java.math.*,db.*,java.sql.*, java.io.*, java.util.*"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
 <title>Actor Introduction Screen</title>
 <link rel="stylesheet" href="persona.css">
 </head>
 <jsp:useBean id="jb" scope="session" class="db.JavaBean" />
 <jsp:setProperty name="jb" property="*" />
 <body>
  <div id="butholder2">
  <h1 align="center" id="titlu">Add a new actor:</h1>
</div>
 <%
 String Nume = request.getParameter("nume");
 String Prenume = request.getParameter("prenume");
 String Rol = request.getParameter("rol");
 String Piesa = request.getParameter("piesa");
if (Nume != null) {
     
     // --- START Submission Logic ---
     
     String idTeatruString = request.getParameter("idteatru");
     long idTeatru = 0; // Initialize variable for safety
     if (idTeatruString != null && !idTeatruString.isEmpty()) {
             idTeatru = Long.parseLong(idTeatruString);    
     }
     jb.connect();
     // 3. Call the correct method with the long ID
     jb.adaugaactori(Nume, Prenume, Rol, Piesa, idTeatru);
     jb.disconnect();
     response.sendRedirect("tabela_actori.jsp");
 %>
 <p>Data: Introdusa cu Succes</p><%
 } else {
 %>

 <form action="adauga_actor.jsp" method="post">
 <table>
 <tr>
 <td align="right">Nume:</td>
 <td> <input type="text" name="nume" size="40" /></td>
 </tr>
 <tr>
 <td align="right">Prenume:</td>
 <td> <input type="text" name="prenume" size="40" /></td>
 </tr>
 <tr>
 <td align="right">Rol:</td>
 <td> <input type="text" name="rol" size="30" /></td>
 </tr>
  <tr>
 <td align="right">Piesa:</td>
 <td> <input type="text" name="piesa" size="30" /></td>
 </tr>
  <tr>
 <td align="right">Teatru:</td>
 <td> 
    <select name="idteatru" id="idteatru_choice">
        <%
        jb.connect();
        ResultSet rsTeatre = jb.vedeTeatre(); 
        while (rsTeatre.next()) {
            long id = rsTeatre.getLong("idteatru");
            String numeTeatru = rsTeatre.getString("nume");
        %>
            <option value="<%= id %>"><%= numeTeatru %></option>
        <%
        }
        rsTeatre.close(); 
        jb.disconnect(); 
        %>
    </select>
</td>
 </tr>
 </table>
  <div id="butholder2">

 <a href="tabela_actori.jsp">
<div class="cssbutton "id="butactori1"><b class="sway-text"><strong>Inapoi</strong></b></div>
</a> 
<p align="center">
    <button type="submit" class="cssbutton" id="butactori1">
        <b class="sway-text"><strong>Adauga Actorul</strong></b>
    </button>
</p>
<a href="../index.html">
<div class="cssbutton "id="butactori1"><b class="sway-text"><strong>Acasa</strong></b></div>
</a> 
 </div>
 </form>
 <%
 }
 %>
 <style>
body{
 background-image: url('assets/take_your_time.png');
 background-size:cover;
 background-position: center center;
 }
 #butactori1
 {
 background-color:grey;
 }
 input[type="text"], 
select {
background-color: #000;
color: #fff;
padding:5px;
width:250px;
font-size:16px;
}
 
</style>

 </body>
</html>