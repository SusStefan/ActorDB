<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ page language="java" import="java.lang.*,java.math.*,db.*,java.sql.*, java.io.*, java.util.*"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
 <title>Adauga Teatru</title>
 </head>
 <jsp:useBean id="jb" scope="session" class="db.JavaBean" />
 <jsp:setProperty name="jb" property="*" />
 <body>
 <%
 String Nume = request.getParameter("nume");
 String Descriere = request.getParameter("descriere");
 String Adresa = request.getParameter("adresa");
 String Oras = request.getParameter("oras");
 if (Nume != null) {
 jb.connect();
 jb.adaugateatru(Nume, Descriere,Adresa,Oras);
 jb.disconnect();
 %>
 <p>Data: Introdusa cu Succes</p><%
 } else {
 %>
 <h1> Suntem in tabela Teatru.</h1>
 <form action="adauga_teatru.jsp" method="post">
 <table>
 <tr>
 <td align="right">Nume Teatru:</td>
 <td> <input type="text" name="nume" size="40" /></td>
 </tr>
 <tr>
 <td align="right">Descriere:</td>
 <td> <input type="text" name="descriere" size="30" /></td>
 </tr>
  <tr>
 <td align="right">Adresa:</td>
 <td> <input type="text" name="adresa" size="30" /></td>
 </tr>
  <tr>
 <td align="right">Nume Oras:</td>
 <td> 
    <select name="idoras" id="idoras_choice">
        <%
        // 1. Get the list of cities
        jb.connect();
        ResultSet rsOrase = jb.vedeOrase(); 

        // 2. Loop through the results to create <option> tags
        while (rsOrase.next()) {
            long id = rsOrase.getLong("idoras");
            String numeOras = rsOrase.getString("nume");
        %>
            <option value="<%= id %>"><%= numeOras %></option>
        <%
        }
        rsOrase.close(); 
        // IMPORTANT: Close the connection if not handled globally
        jb.closeConnection(); 
        %>
    </select>
</td>
 </tr>
 </table>
 <input type="submit" value="Adauga teatrul" />
 </form>
 <%
 }
 %>
 <br/>
 <a href="index.html"><b>Inapoi</b></a>
 <br/>
 </body>
</html>